{
	"variables": {
		"region": "us-west-2",
	        "aws_profile": "packertest",
		"source_ami": "ami-0c7ea5497c02abcaf",
		"instance_type": "t2.micro"
	},
	"builders": [
		{
			"type": "amazon-ebs",
		        "profile": "{{user `aws_profile`}}",
			"region": "{{user `region`}}",
			"instance_type": "{{user `instance_type`}}",
			"source_ami": "{{user `source_ami`}}",
			"ssh_username": "admin",
			"ami_name": "jenkins-main-debian",
			"ami_description": "Debian Image with Jenkins Server",
			"run_tags": {
				"Name": "packer-builder"
			}
		}
	],
	"provisioners": [
		{
			"type": "file",
			"source": "./scripts/basic-security.groovy",
			"destination": "/tmp/"
		},
		{
			"type": "file",
			"source": "./scripts/csrf-protection.groovy",
			"destination": "/tmp/"
		},
		{
			"type": "file",
			"source": "./scripts/disable-cli.groovy",
			"destination": "/tmp/"
		},
		{
			"type": "file",
			"source": "./scripts/disable-jnlp.groovy",
			"destination": "/tmp/"
		},
		{
			"type": "file",
			"source": "./scripts/node-agent.groovy",
			"destination": "/tmp/"
		},
		{
			"type": "file",
			"source": "./scripts/skip-jenkins-setup.groovy",
			"destination": "/tmp/"
		},
		{
			"type": "file",
			"source": "./config/install-plugins.sh",
			"destination": "/tmp/"
		},
		{
			"type": "file",
			"source": "./config/plugins.txt",
			"destination": "/tmp/"
		},
		{
			"type": "file",
			"source": "../.ssh/id_rsa",
			"destination": "/tmp/"
		},
		{
			"type": "shell",
			"script": "./setup_debian.sh",
			"execute_command": "sudo -E -S sh '{{ .Path }}'"
		}
	]
}
